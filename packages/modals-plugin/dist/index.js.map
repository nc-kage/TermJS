{"version":3,"file":"index.js","sources":["../src/Modals/constants.ts","../src/Modals/ModalView/index.ts","../src/Modals/utils/viewport.ts","../src/Modals/index.ts"],"sourcesContent":["export const PLUGIN_NAME = 'modals-plugin';\n\nexport const TERMINAL_CENTER_POSITION = 'terminal-center';\nexport const EDIT_CENTER_POSITION = 'edit-center';\nexport const PRIMARY_BUTTON_TYPE = 'submit';\nexport const GENERAL_BUTTON_TYPE = 'submit';\nexport const DATA_LINE_ATTRIBUTE_NAME = 'modals-plugin-data-line';\nexport const DATA_INDEX_ATTRIBUTE_NAME = 'modals-plugin-data-index';\nexport const ESC_KEY_CODE = 27;\nexport const HIDE_ACTION = 'modals-plugin-hide-action';\n","import template from './template.html';\nimport css from './index.scss';\n\nimport { isArray } from 'lodash-es';\nimport { TemplateEngine } from '@term-js/term';\nimport IModalView from '@Modals/ModalView/IModalView';\nimport { ActionType, OptionsType } from '@Modals/ModalView/types';\nimport {\n  DATA_INDEX_ATTRIBUTE_NAME,\n  DATA_LINE_ATTRIBUTE_NAME,\n  PRIMARY_BUTTON_TYPE,\n} from '@Modals/constants';\n\nclass ModalView extends TemplateEngine implements IModalView {\n  private static stopPropagation = (e: Event) => {\n    e.stopPropagation();\n  }\n\n  private readonly options: OptionsType;\n  private isRendered: boolean = false;\n\n  private get normalizedActions(): ActionType[][] {\n    const { actions = [] } = this.options;\n    if (!actions.length) return [];\n    return (isArray(actions[0]) ? actions : [actions]) as ActionType[][];\n  }\n\n  constructor(container: HTMLElement, options: OptionsType) {\n    super(template, container);\n    this.options = options;\n    this.render();\n  }\n\n  public render() {\n    if (this.isRendered) return;\n    const {\n      title, closeButton, content: optionsContent, actions = [], className = '', isAbsolute = false,\n    } = this.options;\n    super.render({\n      css, className, title, closeButton, actions: Boolean(actions.length),\n      content: typeof optionsContent === 'string' ? optionsContent : '',\n    });\n    if (isAbsolute) {\n      const modal = this.getModalView() as HTMLElement;\n      modal.classList.add(css.absoluteModal);\n    }\n    this.renderActions();\n    this.addEventListeners();\n    this.isRendered = true;\n  }\n\n  public destroy() {\n    this.removeEventListeners();\n    super.destroy();\n  }\n\n  public getModalView(): HTMLElement | undefined {\n    return this.getRef('modal') as HTMLElement;\n  }\n\n  private renderActions() {\n    const { normalizedActions } = this;\n    const actionsContainer = this.getRef('actions') as HTMLElement;\n    normalizedActions.forEach((actionsLine: ActionType[], lineIndex: number) => {\n      const line = document.createElement('div');\n      line.className = css.actionLine;\n      actionsLine.forEach((action: ActionType, itemIndex) => {\n        const actionButton = document.createElement('button');\n        actionButton.className = [\n          css.actionButton,\n          action.type === PRIMARY_BUTTON_TYPE ? css.submitActionButton : css.generalActionButton,\n        ].join(' ');\n        actionButton.innerHTML = action.text;\n        actionButton.setAttribute(DATA_LINE_ATTRIBUTE_NAME, String(lineIndex));\n        actionButton.setAttribute(DATA_INDEX_ATTRIBUTE_NAME, String(itemIndex));\n        line.appendChild(actionButton);\n      });\n      actionsContainer.appendChild(line);\n    });\n  }\n\n  private addEventListeners() {\n    const { normalizedActions } = this;\n    const { overlayHide, closeButton } = this.options;\n    if (overlayHide) this.addOverlayEventListeners();\n    if (closeButton) this.addCloseButtonListener();\n    if (normalizedActions.length) this.addActionsListeners();\n  }\n\n  private addOverlayEventListeners() {\n    const modal = this.getRef('modal') as HTMLElement;\n    const root = this.getRef('root') as HTMLElement;\n    modal.addEventListener('click', ModalView.stopPropagation);\n    root.addEventListener('click', this.onOverlayClick);\n  }\n\n  private addCloseButtonListener() {\n    const { onClose } = this.options;\n    if (onClose) {\n      const closeButton = this.getRef('closeButton') as HTMLElement;\n      closeButton.addEventListener('click', onClose);\n    }\n  }\n\n  private addActionsListeners() {\n    const actions = this.getRef('actions') as HTMLElement;\n    actions.addEventListener('click', this.onActionClick);\n  }\n\n  private onActionClick = (e: Event) => {\n    const { normalizedActions } = this;\n    const target = e.target as HTMLElement;\n    const dataLineValue = target.getAttribute(DATA_LINE_ATTRIBUTE_NAME);\n    const dataIndexValue = target.getAttribute(DATA_INDEX_ATTRIBUTE_NAME);\n    if (dataLineValue && dataIndexValue) {\n      const handler = normalizedActions[Number(dataLineValue)][Number(dataIndexValue)]?.onClick;\n      if (handler) handler(e);\n    }\n  }\n\n  private onOverlayClick = (e: Event) => {\n    const { onClose } = this.options;\n    ModalView.stopPropagation(e);\n    if (onClose) onClose();\n  }\n\n  private removeEventListeners() {\n    const { normalizedActions } = this;\n    const { overlayHide, closeButton } = this.options;\n    if (overlayHide) this.removeOverlayEventListeners();\n    if (closeButton) this.removeCloseButtonListener();\n    if (normalizedActions.length) this.removeActionsListeners();\n  }\n\n  private removeOverlayEventListeners() {\n    const { onClose } = this.options;\n    if (onClose) {\n      const modal = this.getRef('modal') as HTMLElement;\n      const root = this.getRef('root') as HTMLElement;\n      modal.removeEventListener('click', ModalView.stopPropagation);\n      root.removeEventListener('click', onClose);\n    }\n  }\n\n  private removeCloseButtonListener() {\n    const { onClose } = this.options;\n    if (onClose) {\n      const closeButton = this.getRef('closeButton') as HTMLElement;\n      closeButton.removeEventListener('click', onClose);\n    }\n  }\n\n  private removeActionsListeners() {\n    const actions = this.getRef('actions') as HTMLElement;\n    actions.removeEventListener('click', this.onActionClick);\n  }\n}\n\nexport default ModalView;\n","export const getScrollbarSize = (container?: HTMLElement): number => {\n  let { size } = getScrollbarSize as { size?: number };\n  if (size) return size;\n  const target = container || document.body;\n  const div1: HTMLDivElement = document.createElement('div');\n  const div2: HTMLDivElement = document.createElement('div');\n  div1.style.width = '100px';\n  div1.style.height = '100px';\n  div1.style.overflow = 'scroll';\n  div2.style.height = '100px';\n  target.appendChild(div1);\n  div1.appendChild(div2);\n  size = div1.offsetWidth - div2.offsetWidth;\n  target.removeChild(div1);\n  (getScrollbarSize as { size?: number }).size = size;\n  return size;\n};\n\nexport const getRelativePosition = (\n  el: HTMLElement, container: HTMLElement,\n): { top: number; bottom: number; left: number; right: number; width: number; height: number } => {\n  const scrollBarSize = getScrollbarSize(container);\n  const elInfo = el.getBoundingClientRect();\n  const containerInfo = container.getBoundingClientRect();\n  const left = elInfo.left - containerInfo.left;\n  const top = elInfo.top - containerInfo.top;\n  const containerWidth = containerInfo.width - scrollBarSize;\n  const containerHeight = containerInfo.height - scrollBarSize;\n  return {\n    left,\n    top,\n    bottom: containerHeight - top - elInfo.height,\n    right: containerWidth - left - elInfo.width,\n    width: elInfo.width,\n    height: elInfo.height,\n  };\n};\n","import { Plugin, ITermInfo, IKeyboardShortcutsManager } from '@term-js/term';\nimport { v1 } from 'uuid';\nimport { constant, last, noop } from 'lodash-es';\n\nimport './theme.scss';\n\nimport IModals from '@Modals/IModals';\nimport { EDIT_CENTER_POSITION, ESC_KEY_CODE, HIDE_ACTION, PLUGIN_NAME } from '@Modals/constants';\nimport { ModalOptionsType, PositionType } from '@Modals/types';\nimport IModalView from '@Modals/ModalView/IModalView';\nimport ModalView from '@Modals/ModalView';\nimport { getRelativePosition } from '@Modals/utils/viewport';\n\nclass Modals extends Plugin implements IModals {\n  public readonly name: string = PLUGIN_NAME;\n\n  private modalStack: {\n    uuid: string; options: ModalOptionsType; view: IModalView;\n  }[] = [];\n  private unlockCallback?: () => void;\n\n  public setTermInfo(termInfo: ITermInfo, keyboardShortcutsManager: IKeyboardShortcutsManager) {\n    super.setTermInfo(termInfo, keyboardShortcutsManager);\n    keyboardShortcutsManager.addShortcut(HIDE_ACTION, { code: ESC_KEY_CODE });\n    keyboardShortcutsManager.addListener(HIDE_ACTION, this.hideLast);\n  }\n\n  public updateTermInfo(termInfo: ITermInfo) {\n    super.updateTermInfo(termInfo);\n  }\n\n  public clear() {\n    const { modalStack } = this;\n    modalStack.forEach(({ uuid }) => this.hide(uuid));\n    super.clear();\n  }\n\n  public destroy() {\n    this.clear();\n    super.destroy();\n  }\n\n  public show(options: ModalOptionsType): () => void {\n    const { termInfo, unlockCallback, keyboardShortcutsManager } = this;\n    if (!termInfo || !termInfo.elements.root) return noop;\n    const { root } = termInfo.elements;\n    const {\n      content, onClose: closeHandler, title, overlayHide, closeButton, actions, className, position,\n    } = options;\n    termInfo.edit.blur();\n    const uuid = v1();\n    const onClose = () => {\n      this.hide(uuid);\n      if (closeHandler) closeHandler();\n    };\n    const isAbsolute = position === EDIT_CENTER_POSITION;\n    const view = new ModalView(root as HTMLElement, { onClose, content, title, overlayHide,\n      closeButton, actions, className, isAbsolute });\n    if (isAbsolute) this.updatePosition(view, position);\n    this.modalStack.push({ uuid, options, view });\n    if (!unlockCallback && keyboardShortcutsManager) {\n      this.unlockCallback = keyboardShortcutsManager.lock([HIDE_ACTION]);\n    }\n    return onClose;\n  }\n\n  public hide(uuid: string) {\n    const { termInfo, unlockCallback } = this;\n    const { modalStack } = this;\n    const index = modalStack.findIndex(item => item.uuid === uuid);\n    if (index >= 0) {\n      modalStack[index].view.destroy();\n      modalStack.splice(index, 1);\n    }\n    if (!modalStack.length) {\n      if (unlockCallback) unlockCallback();\n      delete this.unlockCallback;\n      termInfo?.edit.focus();\n    }\n  }\n\n  private hideLast = () => {\n    const { modalStack } = this;\n    const lastModal = last(modalStack);\n    if (lastModal && lastModal.options.escHide) {\n      this.hide(lastModal.uuid);\n      if (lastModal.options.onClose) lastModal.options.onClose();\n    }\n  }\n\n  private updatePosition(view: IModalView, position?: PositionType) {\n    const { termInfo } = this;\n    const modal = view.getModalView();\n    if (!modal || !termInfo || position !== EDIT_CENTER_POSITION) return;\n    const { edit, root } = termInfo.elements;\n    if (!edit || !root) return;\n    const { top, bottom } = getRelativePosition(edit as HTMLElement, root as HTMLElement);\n    if (top <= bottom) {\n      modal.style.top = `${Math.max(0, top)}px`;\n    } else if (bottom >= -1 * (edit as HTMLElement).offsetHeight) {\n      modal.style.bottom = `${Math.max(0, bottom)}px`;\n    } else {\n      modal.style.top = '50%';\n      modal.style.transform = 'translate(-50%, -50%)';\n    }\n  }\n}\n\nexport default Modals;\n"],"names":["TemplateEngine","isArray","Plugin","last","noop","uuid","v1"],"mappings":"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"}